<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyATv2F6CKX7jnvQa8XayHj12c2qa-2ECcg",
            authDomain: "lotterymachine-by-mmd.firebaseapp.com",
            projectId: "lotterymachine-by-mmd",
            storageBucket: "lotterymachine-by-mmd.appspot.com",
            messagingSenderId: "977277760191",
            appId: "1:977277760191:web:f55cd69cc7b4ee91504c0a"
        };
        
        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const lockRef = database.ref("lockState");

        function toggleModal(show) {
            document.getElementById("customModal").style.display = show ? "block" : "none";
        }

        function toggleLock() {
            const password = document.getElementById("passwordInput").value;
            if (password === "123") {
                lockRef.once("value").then(snapshot => {
                    const isLocked = snapshot.val() || false;
                    lockRef.set(!isLocked);
                });
                toggleModal(false);
            } else {
                document.getElementById("errorMsg").style.display = "block";
            }
        }

        function updateLockButton(isLocked) {
            const lockButton = document.getElementById("lockButton");
            lockButton.textContent = isLocked ? "Inactive" : "Active";
            lockButton.style.backgroundColor = isLocked ? "orange" : "cyan";
        }

        lockRef.on("value", snapshot => {
            const isLocked = snapshot.val() || false;
            updateLockButton(isLocked);
            if (isLocked) {
                alert("The site is currently locked.");
            }
        });

    </script>
</head>
<body>
    <button id="lockButton" onclick="toggleModal(true)">Active</button>
    <div id="customModal">
        <div id="modalContent">
            <span style="pointer-events: auto;" onclick="toggleModal(false)">&times;</span>
            <p>Enter password to lock/unlock the site:</p>
            <input type="password" id="passwordInput" placeholder="Password">
            <button id="submitBtn" onclick="toggleLock()">Submit</button>
            <div id="errorMsg" style="display:none; color:red;">Incorrect password!</div>
        </div>
    </div>
</body>
</html>
